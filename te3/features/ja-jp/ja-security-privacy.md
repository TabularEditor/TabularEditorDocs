# Tabular Editor 3 セキュリティとプライバシー

このドキュメントはTabular Editor 3のセキュリティとプライバシーに関する考察とその使用について説明しています。以下では、「Tabular Editor」という表現は、商用ツールのTabular Editor 3とオープンソースツールのTabular Editor 2.Xの両方を意味します。何か一方のツールだけを考えるときは、それらの明示的な名前「Tabular Editor 3」または「Tabular Editor 2.X」を使用することにします。

## メタデータとデータプライバシー

すべてのデータとメタデータはTabular Editorがインストールされているクライアントマシンに存在し、すべてのユーザー操作はローカルで実行されます。Tabular Editorの実行と使用にはインターネット接続は必要ありません。

とはいえ、さまざまな目的のためにTabular Editorがリモートサービスに接続するシナリオがあります。これらについては、以下で説明します。

### アナリシスサービスXMLAプロトコル

Analysis ServicesインスタンスまたはPower BI Premiumワークスペースとのすべての通信は、[Microsoft Analysis Management Objects (AMO)](https://docs.microsoft.com/en-us/analysis-services/amo/developing-with-analysis-management-objects-amo?view=asallproducts-allversions) クライアントライブラリ、より具体的には、[Tabular Object Model (TOM) extension for AMO](https://docs.microsoft.com/en-us/analysis-services/tom/introduction-to-the-tabular-object-model-tom-in-analysis-services-amo?view=asallproducts-allversions) の使用によって行われます。これらのクライアントライブラリーはTabular Editorなどのサードパーティーアプリケーションで再配布できるようにMicrosoftから提供されています。ライセンスの詳細については、[AMO EULA](https://go.microsoft.com/fwlink/?linkid=852989)を参照してください。

Tabular EditorがAnalysis Servicesのインスタンス（ローカルネットワークまたはクラウド）またはPower BI Premiumワークスペース（クラウド）に接続するとき、この接続は上記のクライアントライブラリを通じて実行されます。設計上、AMOライブラリはユーザーの認証と認可を処理します。Analysis ServicesインスタンスまたはPower BI Premiumワークスペースの管理者権限を持つユーザーのみ、接続が許可されます。これは、SQL Server Management StudioやSQL Server Data ToolsなどのMicrosoftツールを使用する場合と変わりません（接続に同じクライアント ライブラリを使用します）。

### Tabular Object Model メタデータ

AMO/TOMクライアントライブラリーが接続を確立すると、Tabular Editorはユーザーが接続したい特定のAnalysis ServicesデータベースまたはPower BIデータセットのTabular Object Model（TOM）メタデータを完全に要求するようになります。AMO/TOMクライアントライブラリはこのメタデータをプログラム方式でクライアントアプリケーション（Tabular Editor）に提供し、アプリケーションはオブジェクトの名前の変更、説明の追加、DAX式の修正などのメタデータの変更を適用できるようにします。さらに、AMO/TOMクライアントライブラリは、TOMメタデータをJSONベースのフォーマットにシリアライズするメソッドを提供する。Tabular Editorはこの技術を利用して、データモデル構造のバージョン管理のために、ユーザーがモデルのメタデータをローカルのJSONファイルとして保存できるようにしています。 **Note: このようにして作成された JSON ファイルには、実際のデータ・レコードは含まれません。このファイルには、モデルのメタデータ、つまり、テーブル、列、メジャー、DAX式などモデルの構造に関する情報のみが含まれます。** モデルのメタデータは一般的に機密情報とはみなされませんが、この方法で作成されたファイルを必要な機密性で扱うことはTabular Editorのユーザーの責任です（ファイルを第三者と共有しないなど）。

**Tabular Editorは、ユーザーがとくにそのためのアクションを起こさない限り、AMO/TOMクライアントライブラリーを通じて取得したモデルのメタデータを収集、公開、共有、転送、その他の方法で公開することはありません。**（たとえば、モデルメタデータのJSONファイルをネットワークの共有ロケーションに保存したり、モデルメタデータをAnalysis ServicesやPower BIワークスペースの別のインスタンスにデプロイすることで）

### モデルデータの内容

以下では、「モデルデータ」とは、Analysis ServicesデータベースまたはPower BIデータセット内に格納された実際のデータレコードを指します。ソースデータベースやデータセットによっては、モデルデータは機密である可能性が非常に高い。

ユーザーは接続先のAnalysis ServicesまたはPower BIワークスペースのインスタンスの管理者権限を持っている必要があるため、定義上、ユーザーはAnalysis ServicesデータベースまたはPower BIデータセットのすべてのデータコンテンツにもアクセスできるようになります。Tabular Editorでは、上記のAMOクライアントライブラリを通じてのみデータの取得が可能です。Tabular Editor 3はモデルデータのブラウズとクエリのための機能を提供します。データへのアクセスにどのような技術が使われたとしても、**Tabular Editorは取得したデータをローカルメモリにのみ保存します。Tabular Editorはこのツールで取得したモデルデータを収集、公開、共有、転送、またはその他の方法で公開することはありません**。ユーザーがTabular Editorを通して取得したクエリー結果をコピーまたはエクスポートする場合、コピーまたはエクスポートされたデータをデータの機密性にしたがって取り扱うことはユーザーの責任となります。これは、ExcelやPower BIなどのクライアントツールを使用してAnalysis ServicesデータベースやPower BIデータセットに接続するユーザーが、クエリー結果をコピーするオプションを持っている場合と変わりません。

### Web リクエスト

Tabular Editorは以下の場合に限り、オンラインリソース（Web URL）へのリクエストを実行できます。

- **ライセンス認証** Tabular Editor 3の初回起動時、およびその後定期的に、ツールは弊社のライセンスサービスに対してリクエストを実行することがあります。このリクエストにはユーザーが入力したライセンスキー、ユーザーの電子メールアドレス（提供されている場合）、ローカルマシン名、現在のインストールを識別する一方向エンコードハッシュに関する暗号化された情報が含まれます。このリクエストでは、他のデータは送信されません。このリクエストの目的は、インストールで使用されているライセンスキーの有効化と検証、試用制限の実施、およびユーザーが当社のライセンスサービスを通じてTabular Editor 3のインストールを管理できるようにすることです。
- **アップグレードチェック** Tabular Editor 3を起動するたびに、新しいバージョンのTabular Editor 3が利用可能かどうかを判断するために、当社のアプリケーションサービスにリクエストを行う場合があります。このリクエストにはデータは含まれません。
- **使用状況テレメトリー** デフォルトでは、Tabular Editor 3はユーザーがツールを操作する際に匿名の使用データを収集し、送信します。このデータには、ユーザーがどのUIオブジェクトを操作したか、またそのタイミングについての情報が含まれます。また、このツールで編集されているTabularデータモデルに関する高レベルの情報も含まれます。この情報は、互換性レベルやモード、テーブル数、サーバーの種類（Analysis Services vs. Power BI vs. Power BI Desktop）などのハイレベルなプロパティにのみ関連します。 **この方法では、個人を特定できるデータは収集されません**, また、Tabular Object Model自体のオブジェクト名やDAX式に関する情報も収集しません。ユーザーはいつでもテレメトリーデータの送信をオプトアウトできます。
- **エラー報告** 予期せぬエラーが発生した場合、スタックトレースと（匿名化された）エラーメッセージ、およびユーザーから提供された任意の説明を送信します。ユーザーが遠隔測定データの送信をオプトアウトした場合、エラーレポートも送信されません。
- **DAXフォーマッタの使用**（Tabular Editor 2.xのみ)）DAX式はTabular Editorのボタンをクリックするとフォーマットされる場合があります。この場合、DAX式は（それ以外は）www.daxformatter.comウェブサービスに送信されます。ユーザーがこのボタンをはじめてクリックすると、明示的な警告メッセージが表示され、意思を確認するよう求められます。Tabular Editor 3はDAXコードをフォーマットする際にウェブリクエストを実行しません。
- **ベストプラクティスルールをインポートする。** Tabular Editorには、ユーザーがベストプラクティスルールのリストをJSONベースのフォーマットで取得するためのURLを指定できる機能があります。このタイプのリクエストはURLからJSONデータをダウンロードするだけで、URLへのデータ転送は行われません。
- **C#スクリプトを使用する。** Tabular Editorでは、自動化のためにC#で書かれたコードを書き、実行できます。このようなスクリプトは、C#言語機能および.NETランタイムを使用して、オンラインリソースに接続する可能性があります。実行されたコードが意図しないデータの共有を引き起こさないようにすることは、常にユーザーの責任です。Tabular Editor ApSは一般的にC#スクリプト機能の使用による損害、損失、漏えいに対して責任を負いません。Tabular Editorはユーザーの明示的なアクションなしにC#スクリプトを実行することはありません。

**ライセンス認証サービス、使用状況テレメトリ、エラーレポートを通じて当社が取得した情報は、すべて機密情報として扱われます。当社は、収集したデータをいかなる形でも共有、公表、配布することはありません。**

> [!NOTE]
> システム管理者は、特定の[ポリシー](https://docs.tabulareditor.com/common/policies.html)を強制することができます。このポリシーは、上記のリストに示された機能の一部または全部を無効にするために使用することができます。

## アプリケーションセキュリティ

Tabular EditorはインストールされるWindowsマシン上で昇格した特権を必要とせず、マシン上の制限されたリソースにもアクセスしません。このルールの例外は、タブラーエディターのインストーラーファイル（.msi）を使う場合です。この場合、ツールに必要な実行ファイルとサポートファイルはデフォルトで `Program Files` フォルダーにコピーされ、通常、昇格権限が必要となります。Tabular EditorのバイナリファイルとインストーラーファイルはKapacity A/S発行のコードサイニング証明書で署名されており、コードが第三者によって改ざんされていないことを保証します。

アプリケーションの実行中、外部リソースへのアクセスはすべてAMO/TOMクライアントライブラリまたは前述のウェブリクエストを通じて行われます。

C#スクリプト機能により、Tabular Editorは.NETランタイム内で任意のC#コードを実行できます。このようなコードは、ユーザーの明示的な要求があった場合にのみコンパイルされ、実行されます。C#スクリプトは「マクロ」として保存することもでき、これによりユーザーは複数の異なるスクリプトを簡単に管理、実行できます。コードは、ユーザー自身の`%localappdata%`フォルダーに保存され、ユーザーまたはローカルマシンの管理者のみがスクリプトにアクセスできます。実行されたコードが意図しない副作用を引き起こさないようにすることは、常にユーザーの責任です。いかなる場合においてもTabular Editor ApSはC#スクリプトやカスタムアクション/マクロ機能の使用による損害、損失、漏えいに責任を負いません。
